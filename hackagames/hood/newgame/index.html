<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>New Game - HackaGames</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../style.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "New Game";
        var mkdocs_page_input_path = "hood/newgame.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> HackaGames
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="" href="../../..">ktorz <</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">First-Steps</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../hello/install/">Install</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../hello/first-bot/">First Bot</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../hello/multi-player/">Multiplayer</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Games</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../games/py421/">Py4.2.1</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../games/connect4/">Connect4</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../games/tictactoe/">TicTacToe</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tuto: Learning</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../learning/policy/">Policy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../learning/qlearning/">Q-Learning</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../learning/speed-up/">Speed-up</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../learning/model-based/">Model Based</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Under the hood</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../api/">Protocol API</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../pod/">Pod Class</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">New Game</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../testdriven/">Test-Driven</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../resources/policy.zip"></a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">HackaGames</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Under the hood</li>
      <li class="breadcrumb-item active">New Game</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="game-creation-in-python">Game Creation in Python</h1>
<p>The ideas here is to present step by step the game creation in python with <code>hackapy</code>.</p>
<p>Reminder, <code>hackapy</code> is the HackaGames python librairy helping for the game and players to communicate together.</p>
<h2 id="directory-structure">Directory structure</h2>
<p>In your workspace directory create a subdirectory <code>gameXyz</code> where <code>Xyz</code> identify your new game (<code>gameHello</code> for instance).
This new subdirectory (your working directory) will also include another subdirectory <code>gameEngine</code> regrouping the source code making your game working.</p>
<p>Directory squeletom: </p>
<pre><code>gameHello                # your game folder
  - gameEngine              # sourcecode of the game
</code></pre>
<p>Then we start with 3 files:</p>
<ul>
<li><code>README.md</code> : a Markdown readme first file presenting the game and the rules.</li>
<li><code>gameEngine/__init__.py</code> : a classical python files marking the entrance of your gameEngine package.</li>
<li><code>start-server</code> : a start script, lauching the game server.</li>
</ul>
<h2 id="game-engine">Game Engine</h2>
<p>At minima <code>gameEngine</code> python package include a Game class deriving from <code>hackapy.AbsGame</code> in the  <code>__init__.py</code> file. 
It is suppozed that the new Game class implement the abstract methods of <code>AbsGame</code>:</p>
<pre><code class="language-python">class AbsGame():

    # Game interface :
    def initialize(self):
        # Initialize a new game
        # Return the game configuration (as a PodInterface)
        # the returned Pod is given to player's wake-up method.
        pass

    def playerHand( self, iPlayer ):
        # Return the game elements in the player vision (a PodInterface)
        # the returned pod feed the player's perception method.
        pass

    def applyPlayerAction( self, iPlayer, action ):
        # Apply the action choosen by the player iPlayer.
        # Return a boolean at True if the player terminate its actions for the current turn.
        # False means player need to be activated again before step to another player or another game turn.
        pass

    def tic( self ):
        # called function at turn end, after all player played its actions. 
        pass

    def isEnded( self ):
        # must return True when the game end, and False else.
        pass

    def playerScore( self, iPlayer ):
        # return the player score for the current game (usefull at game ending)
        pass
</code></pre>
<p>A last abstract method is defined: <code>play</code>.
This method is more an inside method re-defined in function of how the players are managed. 
Actually, two strategies are proposed:</p>
<ul>
<li><strong>AbsSequentialGame:</strong> Players are activated at turns. The perception of the game for the <span class="arithmatex">\(i\)</span>-th player and a call to <code>decide</code> are sent after the <span class="arithmatex">\((i-1)\)</span>-th player terminates its actions (<code>applyPlayerAction( (i-1), "action" )</code> returns <em>True</em>).</li>
<li><strong>AbsSimultaneousGame:</strong> (Work In Progress) Players are activated in a simultaneous way. All the players receive their perception of the game then all the players are requested for their actions. Generally action resolution in these kinds of games are resolved in the <code>tic</code> method.</li>
</ul>
<h2 id="example-of-of-the-simple-hello-games">Example of of the simple hello games:</h2>
<p>First, initialize python file and import the <code>hackapy</code> package.</p>
<pre><code class="language-python">#!env python3
&quot;&quot;&quot;
HackaGame - Game - Hello 
&quot;&quot;&quot;
import sys

sys.path.insert( 1, __file__.split('gameHello')[0] )
import hackapy as hg
</code></pre>
<p>Then, the Game implement an abstract sequential game (each player play at turns).
The Game methods to implemented are: <code>initialize</code>, <code>playerHand</code>, <code>applyPlayerAction</code>, <code>isEnded</code> and <code>playerScore</code>.
Here the Hello game simply echo the player action in a terminal <span class="arithmatex">\(3\)</span> times (method <code>applyPlayerAction</code>).</p>
<pre><code class="language-python">class GameHello( hg.AbsSequentialGame ) :

    # Game interface :
    def initialize(self):
        # initialize the counter and only say hello.
        self.counter= 0
        return hg.Pod( 'hello' )

    def playerHand( self, iPlayer ):
        # ping with the increasing counter
        return hg.Pod( 'hi', flags=[ self.counter ] )  

    def applyPlayerAction( self, iPlayer, action ):
        # print the receive action message. And that all.
        print( f&quot;Player-{iPlayer} say &lt; {action} &gt;&quot; )
        return True

    def tic( self ):
        # step on the counter.
        self.counter= min( self.counter+1, 3 )

    def isEnded( self ):
        # if the counter reach it final value
        return self.counter == 3

    def playerScore( self, iPlayer ):
        # All players are winners.
        return 1
</code></pre>
<p>A counter initialized in <code>initialize</code> method, count <span class="arithmatex">\(3\)</span> game turn (i.e. after each player play at-turn) in <code>tic</code> method. 
Then the <code>isEnded</code> method will return <em>True</em>.
The method <code>playerHand</code> informs the player about the counter status.
Finaly, there is no winner and all player will end with a result at <span class="arithmatex">\(1\)</span> (method <code>playerScore</code>).</p>
<h2 id="lets-play">Lets play</h2>
<p>The <code>start-server</code> script will permit to lauch the game server.
It only instancate a Game with a determined number of players then call the <code>AbsGame</code> <code>start</code> method.</p>
<pre><code class="language-python">#!env python3
&quot;&quot;&quot;
HackaGame - Game - Hello 
&quot;&quot;&quot;
from gameEngine import GameHello

game= GameHello()
game.start()
</code></pre>
<p>That it. </p>
<p>You can set your script executable (<code>chmod +x ./gameHello/start-server</code>) and play with your new game:</p>
<pre><code class="language-sh"># In a first shell:
./gameHello/start-server

# In a second shell:
./hackagames/connect-shell
</code></pre>
<h2 id="game-initialization">Game initialization:</h2>
<p><code>AbsGame</code> initialization need a number of players.
By default the value is on <code>1</code>.
However, if you want to fix this number or if you want to add extrat initialization, you need to call the parent initialization in your own.</p>
<p>As reminder in <em>Python</em>, initialization method is named <code>__init__</code> and <code>super()</code> function provides an access to parent methods.</p>
<p>For instance, for a 2 player game:</p>
<pre><code class="language-python">class MyGame( hg.AbsSequentialGame ) :
    # Initialization:
    def __init__(self) :
        super().__init__( numberOfPlayers=2 )
        self._myAttribut= &quot;Some initializations&quot;
</code></pre>
<h2 id="going-futher-command-interpreter">Going futher: Command Interpreter:</h2>
<pre><code class="language-python">from hackapy.command import Command, Option

# Define a command interpreter: 2 options: host address and port:
cmd= Command(
        &quot;start-server&quot;,
        [
            Option( &quot;port&quot;, &quot;p&quot;, default=1400 ),
            Option( &quot;number&quot;, &quot;n&quot;, 2, &quot;number of games&quot; )
        ],
        (
            &quot;star a server fo gameConnect4 on your machine. &quot;
            &quot;gameConnect4 do not take ARGUMENT.&quot;
        ))
# Process the command line: 
cmd.process()
if not cmd.ready() :
    print( cmd.help() )
    exit()

...

game.start( cmd.option(&quot;number&quot;), cmd.option(&quot;port&quot;) )
</code></pre>
<h2 id="going-futher-test-driven">Going futher: Test-Driven:</h2>
<p>You can start with a first : <code>test_01_AbsGame</code> script in a <code>test</code> directory.</p>
<p>to verify the call to HackaGames Games methods...</p>
<pre><code class="language-python">&quot;&quot;&quot;
Test - Hello Games Class
&quot;&quot;&quot;
import sys

sys.path.insert( 1, __file__.split('gameHello')[0] )
import hackapy as hg
import gameHello.gameEngine as ge

def test_gameMethod():
    game= ge.GameHello()

    assert( type( game.initialize().asPod() ) is hg.Pod  )
    assert( type( game.playerHand(1).asPod() ) is hg.Pod )
    assert( game.applyPlayerAction( 1, &quot;sleep&quot; )  )
    game.tic()
    assert( not game.isEnded() )
    assert( game.playerScore(1) == 1 )
</code></pre>
<p>...</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../pod/" class="btn btn-neutral float-left" title="Pod Class"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../testdriven/" class="btn btn-neutral float-right" title="Test-Driven">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../pod/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../testdriven/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../javascripts/mathjax.js"></script>
      <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
