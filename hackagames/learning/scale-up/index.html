<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Scale-Up - HackaGames</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../style.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Scale-Up";
        var mkdocs_page_input_path = "learning/scale-up.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> HackaGames
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="" href="../../..">ktorz <</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">First-Steps</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../hello/install/">Install</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../hello/first-bot/">First Bot</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../hello/multi-player/">Multiplayer</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Games</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../games/py421/">Py4.2.1</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../games/connect4/">Connect4</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../games/tictactoe/">TicTacToe</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tuto: Learning</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../policy/">Policy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../qlearning/">Q-Learning</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../speed-up/">Speed-up</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../model-based/">Model Based</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Under the hood</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../hood/api/">Protocol API</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../hood/pod/">Pod Class</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../hood/newgame/">New Game</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../hood/testdriven/">Test-Driven</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../resources/policy.zip"></a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">HackaGames</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Scale-Up</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="scale-up">Scale-Up</h1>
<p>The goal of the tutorial is to understand, feel the complexity of addressing a system with combinatorial explosion over the number of states...</p>
<p>This tutorial relies on <em>MoveIt</em> game. Make sure you clearly understand the game and its API.</p>
<h2 id="basic-q-learning">Basic Q-Learning:</h2>
<p>In its basic configuration <em>MoveIt</em> involves a <span class="arithmatex">\(6 \times 4\)</span> grid with randomly generated obstacles.
Has a first exercise you can apply basic <em>Q-Learning</em> with a fixed configuration by fixing the random seed at game creation (<code>game= GameMoveIt( seed=128 )</code>).</p>
<p>In this case the system state 'only' involve the positions of the robot and of the humans.
Something as <span class="arithmatex">\(3\)</span> variables into <span class="arithmatex">\(6 \times 4\)</span> possibilities.
We also require the robot target, but will only record the directions (<span class="arithmatex">\(\in [0, 6]\)</span>)...</p>
<pre><code class="language-python">def state(self):
    robot, human1, human2 = tuple(self._mobiles)
    # Path to the goal:
    pathGoal= self._board.path( robot.x(), robot.y(), robot.goalx(), robot.goaly() )
    state= f&quot;{robot.x()}-{robot.y()}-{pathGoal[0]}&quot;
    state+= f&quot;-{human1.x()}-{human1.y()}&quot;
    state+= f&quot;-{human2.x()}-{human2.y()}&quot;
    return state
</code></pre>
<p>At this point the system is modeled with <span class="arithmatex">\((6 \times 4)^3*6\)</span> states.
Lucky for us, the reward can be easily computed at each time steps (in the perception method).</p>
<pre><code class="language-python">    newScore= statePod.value(1)
    reward= newScore - self._score
    self._score= newScore
</code></pre>
<p>You can now apply basic <em>Q-Learning</em> as experimented on <em>4.2.1</em>.</p>
<h2 id="expert-heuristic-optimizations">Expert Heuristic Optimizations:</h2>
<p>A Basic <code>Q-Learning</code> learning is slow and will be blocked at something like <span class="arithmatex">\(-100\)</span> meaning that the robot continues to generate collision.
A first optimization of the approach consists of including expert knowledge to limit the bad actions and to speed up the learning process.</p>
<h3 id="remove-forbidden-actions">Remove forbidden actions:</h3>
<p>At decision time, it is possible to remove from the pool of available actions, the actions driving the robot on an obstacle or on a human.</p>
<h3 id="speed-up-learning-process">Speed-up Learning process</h3>
<p>Each time a new state is visited and recorded on <em>Q</em> dictionary, it is possible to associate the action identified by the path to the robot target with a positive value.</p>
<h3 id="still-negative">Still negative ?</h3>
<p>In fact, the state space does not integrate the trajectory of the humans.
The humans generally move toward their own goal (with error exception).
The humanâ€™s goals are hidden to the robot, but the human trajectory into the bot state to better anticipate the next human's moves.</p>
<h2 id="scale-up_1">Scale-up:</h2>
<p>Mission on a <span class="arithmatex">\(4 \times 6\)</span> grid with <span class="arithmatex">\(2\)</span> humans remains a very limited scenario.
At launch time, it is possible to change the game configuration:</p>
<pre><code class="language-python">game= GameMoveIt(
    seed=128,              # Grid seed for generations...
    sizeHeight=4,          # size of the grid: number of lines  
    sizeLine= 6,           # size of the grid: number of cells in a line 
    numberOfObstacles= 6,  # number of obstacles
    numberOfHuman= 3       # number of humans
)
</code></pre>
<p>The provided solution should be capable of learning rapidly, new behavior on new environment.</p>
<h2 id="local-vs-global-states">Local vs Global States</h2>
<p>The real problem consists in removing the limitation of learning behairio on a unique environment settings,
but to be capable of using the learned policy in all situations.</p>
<p>By integrating map configuration into the state variables, the state space will grow exponentially.</p>
<ul>
<li>Which variables ? For how many states ?</li>
</ul>
<p>A better solution consists to model the system from the point of view of the actions. 
We speak about local versus global models.
For instance, the goal can be characterized as direction and distance rather than <span class="arithmatex">\((x, y)\)</span> coordinate.</p>
<p>Propose a state definition based from robot location in a less dependent way to the grid dimension and try again Q-Learning algorithm.</p>
<p>To notice that local representation would be more suitable with Decision-Tree.</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../javascripts/mathjax.js"></script>
      <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
