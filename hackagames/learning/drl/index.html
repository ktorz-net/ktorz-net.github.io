<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Deep Reinforcement Learning - HackaGames</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../style.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Deep Reinforcement Learning";
        var mkdocs_page_input_path = "learning/drl.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> HackaGames
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="" href="../../..">ktorz <</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">First-Steps</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../hello/install/">Install</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../hello/first-bot/">First Bot</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../hello/multi-player/">Multiplayer</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Games</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../games/py421/">Py4.2.1</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../games/zombuilding/">Zomb'Building</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../games/connect4/">Connect4</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../games/tictactoe/">TicTacToe</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tuto: Learning</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../policy/">Policy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../qlearning/">Q-Learning</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../speed-up/">Speed-up</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../model-based/">Model Based</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tiled Game</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../tiled-land/pickndel/">Pick'n Del</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Under the hood</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../hood/api/">Protocol API</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../hood/pod/">Pod Class</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../hood/newgame/">New Game</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../hood/testdriven/">Test-Driven</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../resources/policy.zip"></a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../resources/learning.zip"></a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../resources/pickndel.zip"></a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">HackaGames</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Deep Reinforcement Learning</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="deep-reinforcement-learning">Deep Reinforcement Learning</h1>
<p><code>/!\</code> UNDER CONSTRUCTION - Create a simple Deep RL approach (Not PPO)</p>
<p>Reinforcement Learning <span class="arithmatex">\(\rightarrow\)</span> What if the structure object to learn is a Deep Neural Network...</p>
<h2 id="binary-image-421-game">Binary Image 421 Game</h2>
<p>To do that we propose play a different version of 421 game. 
As we see with <code>py421</code> game, the game itself is quit simple, using deep reinforcement learning on this game is overkill. 
The hacka game <code>bi421</code> is a forks of <code>py421</code> limited to <em>Solo</em> mode but with a perceived game state presented as a binary image, a black and with drawing of the 3 dices.
Exept of that it is exacly the same game, you can try it with the associated <em>play</em> commands :</p>
<pre><code class="language-sh">hacka-bi421-play
</code></pre>
<p>Here an samples of possible perceived states (in shell format): </p>
<pre><code>┌───────────────────────────────────┐
│ ▀     █     ▄▄▄▄▄▄▄▄▄             │
│   ▀   █     █ ▄   ▄ █             │
│     ▀ █     █ ▄   ▄ █   █▀▀▀▀▀▀▀█ │
│▀▀▀▀▀▀▀▀     █ ▄   ▄ █   █ ▀   ▀ █ │
│             █▄▄▄▄▄▄▄█   █   ▀   █ │
│                         █ ▀   ▀ █ │
└───────────────────────────────────┘
┌───────────────────────────────────┐
│                          █       █│
│             █▀▀▀▀▀▀▀█    █   ▀   █│
│▄▄▄▄▄▄▄▄     █       █    █       █│
│       █     █   ▀   █    ▀▀▀▀▀▀▀▀▀│
│   ▄   █     █       █             │
│       █     ▀▀▀▀▀▀▀▀▀             │
└───────────────────────────────────┘
┌───────────────────────────────────┐
│    █▀▀▀▀▀▀▀█                      │
│    █ ▀     █         █▀▀▀▀▀▀▀█    │
│    █       █ █▀▀▀▀▀▀▀█ ▀     █    │
│    █     ▀ █ █ ▀   ▀ █   ▀   █    │
│    ▀▀▀▀▀▀▀▀▀ █       █     ▀ █    │
│              █ ▀   ▀ █▀▀▀▀▀▀▀▀    │
└───────────────────────────────────┘
┌───────────────────────────────────┐
│▄▄▄▄▄▄▄▄            █ ▄     █      │
│ ▄   ▄ █       ▄▄▄▄▄█       █      │
│ ▄   ▄ █       █    █     ▄ █      │
│ ▄   ▄ █       █   ▄█▄▄▄▄▄▄▄█      │
│▄▄▄▄▄▄▄█       █       █           │
│               █▄▄▄▄▄▄▄█           │
└───────────────────────────────────┘
</code></pre>
<p>The goal is to create an AI learning to play 421 directly from the image.
Because we have a clear understanding of the <em>421</em> game, it whould be easy to appresiate if our AI is fast enouf to learn and if it reached a effecient policy of actions.</p>
<h2 id="bi421-player">Bi421 Player</h2>
<p>The player perceive methods should be adapted to reccord a image of the dice state. </p>
<pre><code class="language-python">    def perceive(self, gameState):
        imgSize= gameState.integer(1)
        self._horizon= gameState.child(1).integer(1)
        self._score= gameState.child(1).value(1)
        self._dicesImage= [
            line.integers() for line in gameState.children()[1:2+imgSize]
        ]
        #print( d6.shell( self._dicesImage ) )
</code></pre>
<p>The <em>diceImage</em> attributs is a matrice of <code>0</code> and <code>1</code> for the 2 possible pixel color.
If necessary, the game provide a tool to render the image into the shell</p>
<pre><code class="language-python">from hackagames.bi421 import d6
# ...
    print( d6.shell( aDicesImage ) )
</code></pre>
<p>There are, still 8 actions : <code>["keep-keep-keep", "roll-keep-keep", ... "roll-roll-roll"]</code></p>
<p>The <a href="https://github.com/ktorz-net/hackagames/blob/master/src/hackagames/bi421/firstBot.py">firstBot.py</a> file provide a complete example of a first bot, playing randomly to <em>bi421</em>.
Then, the next launch script should works prety find, by considering that your <code>FirstBot</code> is implemented in a <code>bi421Bot.py</code> file : </p>
<pre><code class="language-python">from hackagames.bi421 import GameMaster
from bi421Bot import FirstBot as Bot

# Instanciate Game-Master and bot
gameMaster= GameMaster(&quot;Solo&quot;)
bot= Bot()

# Start 1000 games with your bot:
results= gameMaster.launchLocal( [bot], 10000 )

# Analyze the result
botResults= results[0]
print( f&quot;Average scores: {sum(botResults)/len(botResults)}&quot; )
</code></pre>
<h2 id="instanciate-deep-rl">Instanciate Deep RL</h2>
<pre><code class="language-sh">pip install torchrl
</code></pre>
<h2 id="going-further-proximal-policy-optimization">Going Further : Proximal Policy Optimization</h2>
<p>The <em>diceImage</em> is a <span class="arithmatex">\(35 \times 12\)</span> image of <span class="arithmatex">\(2\)</span> possible values (so <em>1 180 591 620 717 411 303 424</em> possible images).
The game itself is not more complexe, only the difficulty to read the information from the game state is increased.
But we dont care about analizing the game state to extract its core, we want an AI to learn the policy of actions, based this state definition.</p>
<p>To do that with deep neural network, the <a href="https://en.wikipedia.org/wiki/Proximal_policy_optimization">Proximal Policy Optimization</a>(PPO) is one of well established approach.
<em>PPO</em> is impletemented into <em>torch</em> librairy and accessible in python with <a href="https://docs.pytorch.org/rl/stable/index.html">PyTorch</a>.</p>
<pre><code class="language-sh">pip install torchrl
</code></pre>
<p>https://docs.pytorch.org/tutorials/intermediate/reinforcement_ppo.html</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../javascripts/mathjax.js"></script>
      <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
