<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Speed-up - HackaGames</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
        <link href="../../style.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">HackaGames</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../../.." class="nav-link">ktorz <</a>
                            </li>
                            <li class="navitem">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">First-Steps <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../hello/install/" class="dropdown-item">Install</a>
</li>
                                    
<li>
    <a href="../../hello/first-bot/" class="dropdown-item">First Bot</a>
</li>
                                    
<li>
    <a href="../../hello/multi-player/" class="dropdown-item">Multi-Player</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Games <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../games/py421/" class="dropdown-item">Py4.2.1</a>
</li>
                                    
<li>
    <a href="../../games/connect4/" class="dropdown-item">Connect4</a>
</li>
                                    
<li>
    <a href="../../games/tictactoe/" class="dropdown-item">TicTacToe</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Tuto: Learning <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../policy/" class="dropdown-item">Policy</a>
</li>
                                    
<li>
    <a href="../qlearning/" class="dropdown-item">Q-Learning</a>
</li>
                                    
<li>
    <a href="../model-based/" class="dropdown-item">Model Based</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Speed-up</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Under the hood <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../hood/api/" class="dropdown-item">Protocol API</a>
</li>
                                    
<li>
    <a href="../../hood/pod/" class="dropdown-item">Pod Class</a>
</li>
                                    
<li>
    <a href="../../hood/newgame/" class="dropdown-item">New Game</a>
</li>
                                    
<li>
    <a href="../../hood/testdriven/" class="dropdown-item">Test-Driven</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../model-based/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../../hood/api/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#speed-up" class="nav-link">Speed-Up</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#experiments" class="nav-link">Experiments</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#dynamic-learning-parameters" class="nav-link">Dynamic Learning Parameters</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#factorized-policy" class="nav-link">Factorized Policy</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="speed-up">Speed-Up</h1>
<p>The advantage of <em>Model-Based</em> learning compared to solutions like <em>Q-Learning</em> is to provide some guarantees on the computed policy.
However, the main goal in machine learning is to build coherent policies as fast as possible (and by doing so, to be capable of scaling up).</p>
<p>That for, learning directly the policy is generally preferred in Reinforcement Learning.
However, solutions like <em>Q-Learning</em> remains inapplicable in real-life problems, and solutions need to be set up to bypass combinatorial explosions.</p>
<h2 id="experiments">Experiments</h2>
<p>First we need to set up an environment to save and monitor our progress in learning policies (or models).</p>
<p>One way to do that is to plot the evolution of the strategy during the learning.
For instance, the package <a href="https://matplotlib.org/stable/tutorials/introductory/pyplot.html">pyplot</a> provides simple tools in this way.</p>
<p>Let generate a plot with one points every <span class="arithmatex">\(500\)</span> games for instance at sleep time.</p>
<pre><code class="language-python">import matplotlib.pyplot as plt

Class Bot:
    def __init__(self):
        # Progress
        self._results= []
        self._evals= []
        # Q-Learning attributes

...
    def sleep(self, result):
        self._results.append(result)
        if len(self._results) == 500 :
            self._evals.append( sum(self._results)/500.0 )
            self._results= []
            self.drawEvaluations()

    def drawEvaluations(self) :
        plt.plot( 
            [ i*500 for i in range(len(self._evals)) ],
            self._evals )
        plt.savefig( &quot;output.png&quot; )
        plt.clf()
</code></pre>
<p>Itâ€™s also possible to save the <em>QValues</em> dictionary and the average score in a file for later use, for instance with <code>json</code> package.</p>
<pre><code class="language-python">fileContent= open(&quot;my-file.json&quot;, &quot;w&quot;)
json.dump( aDictionary, fileContent, sort_keys=True, indent=2 )
fileContent.close()
</code></pre>
<p>Then the load function can rebuild a <code>.json</code> dictionary.</p>
<pre><code class="language-python">if os.path.isfile( &quot;my-file.json&quot; ) :
    fileContent= open(&quot;my-file.json&quot;)
    aDictionary = json.load(fileContent)
    fileContent.close()
</code></pre>
<h2 id="dynamic-learning-parameters">Dynamic Learning Parameters</h2>
<p>Greedy exploit/Explore ratio is limited, notably when the Q-values become stables.
A first solution is to change the ratio dynamically while the systems record experiments.</p>
<p>Typically, QLearning can be configured with a high exploration probability during the first benches of games, and decrease this probability with experience (i.e. each time the <em>bot</em> is wape-up again).
A similar mechanism can be applied to the learning rate.</p>
<p>The parameter of the Qlearning is not directly the Exploration/Explotation ratio and the learning rate,
but the initial and final values, and it decreases speed.</p>
<!-- ## Probabilistic Policy

Greedy exploit/Explore ratio is limited, notably when the Q-values become stables.
A first solution is to change the ratio dynamically while the systems record experiments.
Another solution consists of implementing [probabilistic policies](https://en.wikipedia.org/wiki/Reinforcement_learning#policy).

Using probabilistic policies in _Q-Learning_ the probability to take an action rather than another increase with the differences in _Q-Values_.
-->

<h2 id="factorized-policy">Factorized Policy</h2>
<p>The main idea is that a same action could be defined for several 'similar' states.
So is it possible to group 'similar' states together, to learn faster.</p>
<p><em>Py421</em> advantages the combinations <em>4-2-1</em>, <em>1-1-1</em> or <em>X-1-1</em>. 
A first idea could be to focus state definition to target those combinations.</p>
<p>This idea modeled as a tree will lookalike: <br />
<img alt="DT for 421" src="../dt-421.svg" /></p>
<p>This tree can be implemented with a <em>"if-then-else"</em> procedure into a QLearner Bot, to learn a good behavior on Py421 game only over 7 states.
As a result, learning should be very fast but with a final behavior less performant than learning applied over all the <em>168</em> game states.</p>
<p>In fact, such a solution is close to <em>Decision Tree</em> approaches, a decision support based on a recursive partitioning structure <a href="https://en.wikipedia.org/wiki/Decision_tree">Wikipedia</a>.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/jquery-3.6.0.min.js"></script>
        <script src="../../js/bootstrap.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../javascripts/mathjax.js"></script>
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
